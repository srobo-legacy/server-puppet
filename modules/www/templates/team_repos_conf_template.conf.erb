
########################################################################
#                                                                      #
#    Student Robotics Team Git Repository Access Configuration File    #
#                                                                      #
#     Do not edit this file by hand. Instead, modify the template.     #
#        This file will be regenerated every time puppet runs.         #
#                                                                      #
########################################################################

SetEnv GIT_PROJECT_ROOT <%= ide_root_dir %>/repos
SetEnv GIT_HTTP_EXPORT_ALL

ScriptAliasMatch "^/robogit/([A-Z]*[0-9]?)/([^/]+.git/.*)$" /usr/libexec/git-core/git-http-backend/$1/master/$2

## --PER-TEAM-START-- ##

# Team {TLA}-specific block
<Location /robogit/{TLA}>
	AuthType basic
	AuthName "Student Robotics Team {TLA} Git repositories"
	AuthBasicProvider ldap

	AuthzLDAPAuthoritative On
	AuthLDAPURL ldap://localhost:389/ou=users,o=sr?uid?base?(objectClass=*)
	AuthLDAPBindDN "uid=anon,ou=users,o=sr"
	AuthLDAPBindPassword "{ldap_passwd}"

	AuthLDAPGroupAttribute memberUid
	AuthLDAPGroupAttributeIsDN off

	Require ldap-group cn={team_prefix}{TLA},ou=groups,o=sr
	Require valid-user

</Location>

## --PER-TEAM-END-- ##
